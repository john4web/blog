<!DOCTYPE html>
<html lang="en">

<head>
  <title>
  Liskov substitution principle and DbC in depth ¬∑ gersti.at
</title>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="color-scheme" content="light dark">




<meta name="author" content="Johannes Gerstbauer">
<meta name="description" content="Article explaining the liskov substitution principle and Design by Contract in depth.">
<meta name="keywords" content="blog, developer, software, engineer">

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Liskov substitution principle and DbC in depth"/>
<meta name="twitter:description" content="Article explaining the liskov substitution principle and Design by Contract in depth."/>

<meta property="og:title" content="Liskov substitution principle and DbC in depth" />
<meta property="og:description" content="Article explaining the liskov substitution principle and Design by Contract in depth." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://gersti.at/posts/liskov-substitution-principle/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-09-11T00:00:00+00:00" />
<meta property="article:modified_time" content="2024-09-11T00:00:00+00:00" />




<link rel="canonical" href="https://gersti.at/posts/liskov-substitution-principle/">


<link rel="preload" href="/fonts/forkawesome-webfont.woff2?v=1.2.0" as="font" type="font/woff2" crossorigin>


  
  
  <link rel="stylesheet" href="/css/coder.min.e1bdf152d93b060b06ba5d496486ed9c201a8b95d335e035beb5faebe3b61cad.css" integrity="sha256-4b3xUtk7BgsGul1JZIbtnCAai5XTNeA1vrX66&#43;O2HK0=" crossorigin="anonymous" media="screen" />






  
    
    
    <link rel="stylesheet" href="/css/coder-dark.min.a00e6364bacbc8266ad1cc81230774a1397198f8cfb7bcba29b7d6fcb54ce57f.css" integrity="sha256-oA5jZLrLyCZq0cyBIwd0oTlxmPjPt7y6KbfW/LVM5X8=" crossorigin="anonymous" media="screen" />
  



 




<link rel="icon" type="image/svg+xml" href="/images/favicon.svg" sizes="any">
<link rel="icon" type="image/png" href="/images/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/images/favicon-16x16.png" sizes="16x16">

<link rel="apple-touch-icon" href="/images/apple-touch-icon.png">
<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/images/safari-pinned-tab.svg" color="#5bbad5">









</head>






<body class="preload-transitions colorscheme-auto">
  
<div class="float-container">
    <a id="dark-mode-toggle" class="colorscheme-toggle">
        <i class="fa fa-adjust fa-fw" aria-hidden="true"></i>
    </a>
</div>


  <main class="wrapper">
    <nav class="navigation">
  <section class="container">
    <a class="navigation-title" href="/">
      gersti.at
    </a>
    
      <input type="checkbox" id="menu-toggle" />
      <label class="menu-button float-right" for="menu-toggle">
        <i class="fa fa-bars fa-fw" aria-hidden="true"></i>
      </label>
      <ul class="navigation-list">
        
          
            <li class="navigation-item">
              <a class="navigation-link" href="/posts/">Blog</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link" href="/about/">About</a>
            </li>
          
        
        
          
          
          
            
              
                <li class="navigation-item menu-separator">
                  <span>|</span>
                </li>
                
              
              <li class="navigation-item">
                <a href="/de/posts/liskov-substitution-principle/">üá©üá™</a>
              </li>
            
          
        
      </ul>
    
  </section>
</nav>


    <div class="content">
      
  <section class="container post">
    <article>
      <header>
        <div class="post-title">
          <h1 class="title">
            <a class="title-link" href="https://gersti.at/posts/liskov-substitution-principle/">
              Liskov substitution principle and DbC in depth
            </a>
          </h1>
        </div>
        <div class="post-meta">
          <div class="date">
            <span class="posted-on">
              <i class="fa fa-calendar" aria-hidden="true"></i>
              <time datetime="2024-09-11T00:00:00Z">
                September 11, 2024
              </time>
            </span>
            <span class="reading-time">
              <i class="fa fa-clock-o" aria-hidden="true"></i>
              22-minute read
            </span>
          </div>
          
          
          
        </div>
      </header>

      <div class="post-content">
        
        <p>This blog post offers a detailed explanation of the liskov substitution principle and gives an overview of the rules you should follow as a software engineer when dealing with inheritance in object-oriented programming to produce clean code. The following is a summary of some <a href="#reference" >sources</a> I have read however also includes my own opinion on that topic. Code examples are written in Java.</p>
<h2 id="overview">
  Overview
  <a class="heading-link" href="#overview">
    <i class="fa fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<p>The Liskov Substitution Principle (LSP) was first introduced by <a href="https://en.wikipedia.org/wiki/Barbara_Liskov"  class="external-link" target="_blank" rel="noopener">Barbara Liskov</a> in 1987 in her article <a href="https://www.cs.tufts.edu/~nr/cs257/archive/barbara-liskov/data-abstraction-and-hierarchy.pdf"  class="external-link" target="_blank" rel="noopener">&ldquo;Data Abstraction and Hierarchy&rdquo;</a> and is one of the five SO<strong>L</strong>ID design principles of object-oriented programming.</p>
<figure><img src="/images/liskov-substitution-principle/barbara_liskov.jpg"
         alt="Barbara Liskov (Source: Wikipedia)." width="200"/><figcaption>
            <p>Barbara Liskov (Source: <a href="https://commons.wikimedia.org/wiki/File:Barbara_Liskov_computer_scientist_2010.jpg"  class="external-link" target="_blank" rel="noopener">Wikipedia</a>).</p>
        </figcaption>
</figure>

<p>The original definition of this principle is as follows:<br>
<strong><em>If for each object o1 of type S there is an object o2 of type T such that for all programs P defined in terms of T, the behavior of P is unchanged when o1 is substituted for o2, then S is a subtype of T.</em></strong></p>
<p>Ok, that sounds pretty complicated. So what does that even mean?</p>
<p>The LSP states that a program using objects of a base class <code>T</code> should be able to work correctly with objects of its derived class <code>S</code> without altering the program. In other words, all subclasses must behave in the same way as the base class.</p>
<p>Simply put:
If <code>S</code> is a Subtype of <code>T</code>, then objects of type <code>T</code> may be replaced by objects of type <code>S</code>.</p>
<p>Wherever you are using the base type, you should be able to use the subtype instead without causing any unwanted behavior in the program. That means: <em>&ldquo;Subtypes must be <strong>substitutable</strong> for their base types.&rdquo;</em></p>
<p>Let&rsquo;s take a closer look at that concept with an example:<br>
Assume that class S inherits from class <code>T</code>.</p>
<figure><img src="/images/liskov-substitution-principle/inheritance_1.svg"
         alt="Class S inherits from class T." width="200" height="300"/><figcaption>
            <p>Class S inherits from class T.</p>
        </figcaption>
</figure>

<p>And then, let&rsquo;s imagine that we have written a program where we have used class <code>T</code> in multiple places in the code and created instances of it <code>T t = new T()</code>. Now, we need to ensure that we can replace instances of class <code>T</code> with instances of class <code>S</code> at all these points without changing the program&rsquo;s behavior.</p>
<p>So instead of</p>
<p><code>T t = new T()</code></p>
<p>you should be able to use</p>
<p><code>T t = new S()</code></p>
<p>and then the program should behave exactly the same way as before.<br>
If this is the case, then the LSP holds. <code>S</code> was substituted for <code>T</code>!</p>
<h2 id="animals-cats-dogs-and-tables">
  Animals, Cats, Dogs and Tables
  <a class="heading-link" href="#animals-cats-dogs-and-tables">
    <i class="fa fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<p>Let&rsquo;s take a step back and address a more fundamental question:<br>
<em>How should you actually use inheritance in programming?</em></p>
<p>Consider a classic example where the subclass <code>Cat</code> extends the base class <code>Animal</code>.</p>
<figure><img src="/images/liskov-substitution-principle/inheritance_2.svg"
         alt="Class Cat inherits from class Animal." width="200" height="300"/><figcaption>
            <p>Class Cat inherits from class Animal.</p>
        </figcaption>
</figure>

<p>If the <code>Animal</code> can do certain things, then the <code>Cat</code> must also be able to do all these things. All subclasses of Animal must be able to do these things.
But the subclasses may also be able to do more things than the base class. And by more things, I mean more <strong>specific</strong> things. The Cat class may contain the <code>meow()</code> method. But the Animal class does not contain the <code>meow()</code> method because it is a specific behavior of a cat. But that&rsquo;s not a problem, because the Cat class can still be used instead of the Animal class without changing the behavior of the program. Because a cat can do everything that an animal can do in exactly the same way. So the LSP holds.</p>
<ul>
<li>This means: a Cat is a subset of an Animal.</li>
<li>This means: a Cat <strong>IS</strong> an Animal.</li>
<li>This means: an Animal is not necessarily a Cat. An Animal can also be a dog, for example.</li>
</ul>
<p>This is why we speak of an <em>is-a</em> relation in programming when we talk about inheritance.</p>
<p>For example: a table is not an animal and therefore does not inherit from animal and therefore is not a subset of Animal.</p>
<figure><img src="/images/liskov-substitution-principle/circle.svg"
         alt="Cat is a subset of Animal because it can do everything an animal can do (and more). Table is not a subset of Animal."/><figcaption>
            <p>Cat is a subset of Animal because it can do everything an animal can do (and more). Table is not a subset of Animal.</p>
        </figcaption>
</figure>

<h2 id="lsp-definition">
  LSP Definition
  <a class="heading-link" href="#lsp-definition">
    <i class="fa fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<p>Let&rsquo;s take a closer look at the original definition from Barbara Liskov (slightly simplified):</p>
<p><em>If for each object Os of type S there is an object Ot of type T such that for all programs P defined in terms of T, the behavior of P is unchanged when Os is substituted for Ot, then S is a subtype of T.</em></p>
<p>The following diagram tries to explain this definition in a visual way:</p>
<figure><img src="/images/liskov-substitution-principle/definition.svg"
         alt="LSP definition explained as a diagram."/><figcaption>
            <p>LSP definition explained as a diagram.</p>
        </figcaption>
</figure>

<ul>
<li>Os is an instance of class S.</li>
<li>Ot is an instance of class T.</li>
<li>The program P uses Ot.</li>
<li>The program P&rsquo; uses Os.</li>
</ul>
<p>If you use Os instead of Ot in Program P, and the behaviour of Program P is unchanged, then the LSP holds.<br>
That means P&rsquo; must behave exactly like P.</p>
<h2 id="practical-example-violated-lsp">
  Practical Example: Violated LSP
  <a class="heading-link" href="#practical-example-violated-lsp">
    <i class="fa fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<p>When is the LSP actually violated?<br>
<em>If you are inheriting from the base class without making the subclass substitutable for the base class, then you are breaking the LSP.</em><br>
In the following, a classic example of a program with violated LSP is shown. Consider we have a class Rectangle and a class Square where Square extends Rectangle.</p>
<figure><img src="/images/liskov-substitution-principle/rectangle.svg"
         alt="Class Square inherits from class Rectangle."/><figcaption>
            <p>Class Square inherits from class Rectangle.</p>
        </figcaption>
</figure>

<p>In this example, square is not a proper subtype of rectangle, because the height and width of the rectangle are independently mutable. In contrast, the height and width of the square must change together. Since the user believes it is communicating with a rectangle, it could easily get confused.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">Rectangle</span> <span class="n">r</span> <span class="o">=</span> <span class="n">_________</span>
</span></span><span class="line"><span class="cl"><span class="n">r</span><span class="o">.</span><span class="na">setHeight</span><span class="o">(</span><span class="mi">5</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="n">r</span><span class="o">.</span><span class="na">setWidth</span><span class="o">(</span><span class="mi">2</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="k">assert</span><span class="o">(</span><span class="n">r</span><span class="o">.</span><span class="na">area</span><span class="o">()</span> <span class="o">==</span> <span class="mi">10</span><span class="o">)</span>
</span></span></code></pre></div><p>If the blank line above produced a square, then the assertion would fail.</p>
<p>However let‚Äôs take a deeper look into the java code of this example. A rectangle can set its width and height independently. In contrast, whenever the width/height of a square is set, the height/width is changed accordingly.
the setWidth() and setHeight() functions are inappropriate for a Square, since the width and height of a square are identical. So we notice that something goes wrong here. However let‚Äôs ignore this indication that there is a problem and sidestep this problem by overriding the setWidth and setHeight methods.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">class</span> <span class="nc">Rectangle</span><span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="n">width</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="n">height</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">setHeight</span><span class="o">(</span><span class="n">height</span><span class="o">){</span>
</span></span><span class="line"><span class="cl">    <span class="k">this</span><span class="o">.</span><span class="na">height</span> <span class="o">=</span> <span class="n">height</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">  <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">setWidth</span><span class="o">(</span><span class="n">width</span><span class="o">){</span>
</span></span><span class="line"><span class="cl">    <span class="k">this</span><span class="o">.</span><span class="na">width</span> <span class="o">=</span> <span class="n">width</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">  <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">area</span><span class="o">(){</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">width</span> <span class="o">*</span> <span class="n">height</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">  <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">class</span> <span class="nc">Square</span> <span class="kd">extends</span> <span class="n">Rectangle</span><span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">  <span class="n">setHeight</span><span class="o">(</span><span class="n">height</span><span class="o">){</span>
</span></span><span class="line"><span class="cl">    <span class="k">this</span><span class="o">.</span><span class="na">height</span> <span class="o">=</span> <span class="n">height</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">this</span><span class="o">.</span><span class="na">width</span> <span class="o">=</span> <span class="n">height</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">  <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">  <span class="n">setWidth</span><span class="o">(</span><span class="n">width</span><span class="o">){</span>
</span></span><span class="line"><span class="cl">    <span class="k">this</span><span class="o">.</span><span class="na">width</span> <span class="o">=</span> <span class="n">width</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">this</span><span class="o">.</span><span class="na">height</span> <span class="o">=</span> <span class="n">width</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">  <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><p>When using the code now, there is unexpected behaviour when using the square instead of the rectangle. Hence, the LSP breaks! Note: <em>You should never receive anything unexpected from a subclass.</em></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">Rectangle</span> <span class="n">r</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Rectangle</span><span class="o">()</span>
</span></span><span class="line"><span class="cl"><span class="n">r</span><span class="o">.</span><span class="na">setHeight</span><span class="o">(</span><span class="mi">5</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="n">r</span><span class="o">.</span><span class="na">setWidth</span><span class="o">(</span><span class="mi">2</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">r</span><span class="o">.</span><span class="na">area</span><span class="o">());</span> <span class="c1">// 10
</span></span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">Rectangle</span> <span class="n">r</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Square</span><span class="o">()</span>
</span></span><span class="line"><span class="cl"><span class="n">r</span><span class="o">.</span><span class="na">setHeight</span><span class="o">(</span><span class="mi">5</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="n">r</span><span class="o">.</span><span class="na">setWidth</span><span class="o">(</span><span class="mi">2</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">r</span><span class="o">.</span><span class="na">area</span><span class="o">());</span> <span class="c1">// 4
</span></span></span></code></pre></div><p>A solution to this problem could be introducing a Shape class, where Rectangle and square are inheriting from:</p>
<figure><img src="/images/liskov-substitution-principle/shape.svg"
         alt="Square and Rectangle both inherit from Shape."/><figcaption>
            <p>Square and Rectangle both inherit from Shape.</p>
        </figcaption>
</figure>

<p>Or an even better solution: <strong>use composition instead of inheritance</strong>.</p>
<h2 id="method-overriding">
  Method Overriding
  <a class="heading-link" href="#method-overriding">
    <i class="fa fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<p>The previous example showed a violation of the LSP. The LSP was violated because the methods setWidth() and setHeight() were overridden in the subclass. As the two methods in the subclass behaved differently, Square could no longer be used instead of Rectangle without changing the behaviour of the program. You may be asking yourself:</p>
<p><strong>Does that mean method overriding is always a violation of Liskov Substitution Principle?</strong><br>
-&gt; Answer: <em>&ldquo;it depends!&rdquo;</em></p>
<p>The biggest problem with method overriding is that some specific method implementations in the derived classes might not fully adhere to the LSP and therefore fail to preserve type substitutability. Of course, it&rsquo;s valid to make an overridden method to accept arguments of different types and return a different type as well, but with full adherence to the following five rules:</p>
<p><strong>1.</strong> If a method in the base class takes argument(s) of a given type, the overridden method should take the same type or a supertype (A.K.A. <a href="https://en.wikipedia.org/wiki/Covariance_and_contravariance_%28computer_science%29#Contravariant_method_parameter_type"  class="external-link" target="_blank" rel="noopener">contravariant method arguments</a>).</p>
<p><strong>2.</strong> If a method in the base class returns void, the overridden method should return void as well.</p>
<p><strong>3.</strong> If a method in the base class returns a primitive, the overridden method should return the same primitive.</p>
<p><strong>4.</strong> If a method in the base class returns a certain type, the overridden method should return the same type or a subtype (A.K.A. <a href="https://en.wikipedia.org/wiki/Covariant_return_type"  class="external-link" target="_blank" rel="noopener">covariant return type</a>).</p>
<p><strong>5.</strong> If a method in the base class throws an exception, the overridden method must throw the same exception or a subtype of the base class exception.</p>
<h2 id="design-by-contract-preconditions-postconditions-invariants">
  Design by Contract (Preconditions, Postconditions, Invariants)
  <a class="heading-link" href="#design-by-contract-preconditions-postconditions-invariants">
    <i class="fa fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<p>It is well known that &ldquo;contracts&rdquo; are an important concept in software development. Modules must be able to rely on each other by adhering to &ldquo;rules&rdquo; that have been agreed on in advance. Design by Contract (DbC) is an approach to design software in this way. The aim is to ensure the smooth interaction of individual program modules by defining formal contracts.</p>
<p>DbC was developed and introduced by <a href="https://en.wikipedia.org/wiki/Bertrand_Meyer"  class="external-link" target="_blank" rel="noopener">Bertrand Meyer</a> with the development of the programming language <a href="https://en.wikipedia.org/wiki/Eiffel_%28programming_language%29"  class="external-link" target="_blank" rel="noopener">Eiffel</a>.</p>
<figure><img src="/images/liskov-substitution-principle/bertrand_meyer.jpg"
         alt="Bertrand Meyer (Source: Wikipedia)." width="200"/><figcaption>
            <p>Bertrand Meyer (Source: <a href="https://commons.wikimedia.org/wiki/File:Bertrand_Meyer_recent.jpg"  class="external-link" target="_blank" rel="noopener">Wikipedia</a>).</p>
        </figcaption>
</figure>

<p>The idea of DbC is to define as precisely as possible what a software module should do.</p>
<p>The credo: <em>&ldquo;If we don&rsquo;t state what a module should do, there is little likelihood that it will do it.&rdquo;</em></p>
<p>One of the main goals of DbC is increasing software quality (reliability). The smooth interaction between program modules is achieved through a contract that must be adhered to when using a method, for example. This contract consists of preconditions, postconditions and class invariants.</p>
<h3 id="preconditions">
  Preconditions
  <a class="heading-link" href="#preconditions">
    <i class="fa fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<p>Preconditions are assurances that the caller must adhere to.<br>
Preconditions determine under what circumstances a method should be callable.<br>
Preconditions are requirements that must be met before calling a method. These conditions describe the expected state of the system or input before the method is executed. If the preconditions are not met, the method may either throw an exception or handle the error in another way.</p>
<p>The following Code example shows a method with the defined <strong>Precondition: 0 &lt; num &lt;= 5</strong>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Foo</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">doStuff</span><span class="o">(</span><span class="kt">int</span> <span class="n">num</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// precondition: 0 &lt; num &lt;= 5
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="o">(</span><span class="n">num</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="o">||</span> <span class="n">num</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">throw</span> <span class="k">new</span> <span class="n">IllegalArgumentException</span><span class="o">(</span>
</span></span><span class="line"><span class="cl">              <span class="s">&#34;Invalid Precondition: Input out of range 1 ‚Äì 5&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// perform some operations here‚Ä¶
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><p>In this example, the precondition for the <code>doStuff</code> method states that the <code>num</code> parameter value must be in the range 1 to 5. This precondition is enforced with a range check inside the method. If the precondition is not met, an IllegalArgumentException is thrown.
When the precondition is not met (i.e. its evaluation results in false), then the code that is calling the method is wrong. The caller has to ensure that the precondition is met beforehand.</p>
<h3 id="postconditions">
  Postconditions
  <a class="heading-link" href="#postconditions">
    <i class="fa fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<p>Postconditions are assurances that the callee will uphold.<br>
Postconditions specify the conditions that must be met after the completion of the method call.<br>
Postconditions are requirements that should apply after the execution of a method. These conditions describe the expected state of the system or return values after the method has been successfully completed.</p>
<p>The following Code example shows a method with the defined <strong>Postcondition: newNum &gt; num</strong>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Foo</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">doStuff</span><span class="o">(</span><span class="kt">int</span> <span class="n">num</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// perform operation
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">        <span class="kt">int</span> <span class="n">newNum</span> <span class="o">=</span> <span class="n">num</span> <span class="o">+</span> <span class="mi">1</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// postcondition:  newNum must be greater than num
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="o">(</span><span class="n">newNum</span> <span class="o">&lt;=</span> <span class="n">num</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">throw</span> <span class="k">new</span> <span class="n">IllegalStateException</span><span class="o">(</span>
</span></span><span class="line"><span class="cl">              <span class="s">&#34;Invalid Postcondition: newNum must be greater than num&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">newNum</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><p>In this example, the postcondition for the doStuff method states that the <code>newNum</code> value must be bigger than the <code>num</code> value at the end of the method execution. This postcondition is enforced with a check after the performed operation and before the value gets returned. If the postcondition is not met, an IllegalState exception is thrown. If a postcondition is not fulfilled, there is an error in the subroutine itself (i.e. in the operations within the method): The subroutine should have ensured that the postcondition is fulfilled.</p>
<p>To sum up, preconditions and postconditions form a kind of contract: If the calling code fulfills the precondition, then the subroutine is obliged to fulfill the postcondition.</p>
<h3 id="class-invariants">
  Class Invariants
  <a class="heading-link" href="#class-invariants">
    <i class="fa fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<p>Invariants are <strong>immutable</strong> basic assumptions that apply across all instances of a class.
Invariants ensure, that certain conditions (or states) are met at entry <strong>and</strong> exit point of methods.
Therefore, Invariants are a combination of pre- and postconditions together.
In Java, invariants refer to conditions or properties that should remain unchanged throughout the entire life cycle of an object. Invariants play an important role in ensuring the consistency and validity of objects. <em>A class invariant is an assertion concerning object properties that must be true for all valid states of the object.</em></p>
<p>The following Code example shows a method with the defined <strong>Invariant: num &lt; limit</strong>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Foo</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// invariant: num &lt; limit (should apply in every state)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="kt">int</span> <span class="n">limit</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">doStuff</span><span class="o">(</span><span class="kt">int</span> <span class="n">num</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1">//precondition:  num &lt; limit
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">if</span> <span class="o">(</span><span class="n">num</span> <span class="o">&gt;=</span> <span class="n">limit</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">throw</span> <span class="k">new</span> <span class="n">IllegalArgumentException</span><span class="o">(</span>
</span></span><span class="line"><span class="cl">              <span class="s">&#34;Invalid Precondition: num must be below limit&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// perform operation
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="kt">int</span> <span class="n">newNum</span> <span class="o">=</span> <span class="n">num</span> <span class="o">+</span> <span class="mi">1</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// postcondition:  num &lt; limit
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">if</span> <span class="o">(</span><span class="n">num</span> <span class="o">&gt;=</span> <span class="n">limit</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">throw</span> <span class="k">new</span> <span class="n">IllegalStateException</span><span class="o">(</span>
</span></span><span class="line"><span class="cl">              <span class="s">&#34;Invalid Postcondition: num must be below limit&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">newNum</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><p>The Foo class specifies a class invariant that <code>num</code> must always be below the limit. This rule should apply for every state in which the program may be. In the code example the invariant is enforced with a check before and after the performed operation. If the invariant is violated, an exception is thrown.</p>
<p>As illustrated in the previous three code examples, preconditions, postconditions and invariants are usually formulated as Boolean expressions.</p>
<ul>
<li>Precondition: Is checked before the method is executed.</li>
<li>Postcondition: Is checked after the method is executed.</li>
<li>Invariant: Is checked before and after the execution of the method.</li>
</ul>
<p>If every code adheres to the contract, no errors can occur and the method is guaranteed not to deliver unexpected results. The use of DbC creates a chain of contracts that ultimately ensures more robust software. If every single element in the chain can guarantee to fulfill the postcondition when the precondition has been met beforehand, fewer errors occur due to incorrect assumptions of developers.</p>
<p><strong>But what does this have to do with the LSP?</strong><br>
-&gt; By defining class invariants, preconditions and postconditions, a module can be replaced by any other module if it fulfills the same &ldquo;contract&rdquo;. And that is exactly what the LSP is all about.</p>
<h2 id="three-rules-to-create-well-behaved-subtypes">
  Three rules to create well-behaved subtypes
  <a class="heading-link" href="#three-rules-to-create-well-behaved-subtypes">
    <i class="fa fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<p>In their book <em><a href="https://www.oreilly.com/library/view/program-development-in/9780768685299/"  class="external-link" target="_blank" rel="noopener">&ldquo;Program Development in Java: Abstraction, Specification, and Object-Oriented Design&rdquo;</a></em>, Barbara Liskov and John Guttag formulated three rules to create subtypes that adhere to the LSP ‚Äì the signature rule, the properties rule, and the methods rule.</p>
<h3 id="the-methods-rule">
  The methods rule
  <a class="heading-link" href="#the-methods-rule">
    <i class="fa fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<p>Definition:<br>
<em>Calls of subtype methods must &ldquo;behave like&rdquo; calls to the corresponding supertype methods. A subtype method can <strong>weaken the precondition</strong> and can <strong>strengthen the postcondition</strong>. Both conditions must be satisfied to achieve compatibility between the sub- and supertype methods.</em></p>
<h4 id="weaken-the-precondition-by-example">
  Weaken the precondition by example
  <a class="heading-link" href="#weaken-the-precondition-by-example">
    <i class="fa fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h4>
<p>A subtype can weaken (but not strengthen) the precondition for a method it overrides. When a subtype weakens the precondition, it relaxes the constraints imposed by the supertype method.</p>
<p>Example: the <code>doStuff()</code> method in the <code>Foo</code> class defines that the method input <code>num</code> must have a value in between 0 and 6 (0 &lt; num &lt;= 5).</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Foo</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">   
</span></span><span class="line"><span class="cl">   <span class="kd">public</span> <span class="kt">void</span> <span class="nf">doStuff</span><span class="o">(</span><span class="kt">int</span> <span class="n">num</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">       <span class="c1">// precondition: 0 &lt; num &lt;= 5
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>       <span class="c1">// perform some operations here‚Ä¶
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>   <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><p>Let&rsquo;s now override the doStuff method with a weakened precondition:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Bar</span> <span class="kd">extends</span> <span class="n">Foo</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">       
</span></span><span class="line"><span class="cl">   <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">   <span class="kd">public</span> <span class="kt">void</span> <span class="nf">doStuff</span><span class="o">(</span><span class="kt">int</span> <span class="n">num</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">       <span class="c1">// precondition: 0 &lt; num &lt;= 10
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>       <span class="c1">// perform some operations here‚Ä¶
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>   <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><p>Here, the precondition is weakened in the overridden doStuff method to 0 &lt; num &lt;= 10, allowing a wider range of values for num. All values of num that are valid for Foo.doStuff are valid for Bar.doStuff as well. Consequently, a client of Foo.doStuff doesn‚Äôt notice a difference when it replaces Foo with Bar.
Conversely, when a subtype strengthens the precondition (e.g. 0 &lt; num &lt;= 3 in our example), it applies more stringent restrictions than the supertype (and this is not allowed). For example, values 4 &amp; 5 for num are valid for Foo.doStuff, but are no longer valid for Bar.doStuff. This would break the client code that does not expect this new tighter constraint.</p>
<h4 id="strengthen-the-postcondition-by-example">
  Strengthen the postcondition by example
  <a class="heading-link" href="#strengthen-the-postcondition-by-example">
    <i class="fa fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h4>
<p>The subtype can strengthen (but not weaken) the postcondition for a method it overrides. When a subtype strengthens the postcondition, it provides more than the supertype method.</p>
<p>Example: the <code>doStuff()</code> method in the <code>Foo</code> class defines the postcondition newNum &gt; num.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Foo</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   <span class="kd">public</span> <span class="kt">int</span> <span class="nf">doStuff</span><span class="o">(</span><span class="kt">int</span> <span class="n">num</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">       <span class="c1">// perform operation
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>       <span class="c1">// postcondition:  newNum &gt; num
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>   <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><p>Let&rsquo;s now override the <code>doStuff()</code> method with a strengthened postcondition:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Bar</span> <span class="kd">extends</span> <span class="n">Foo</span><span class="o">{</span>
</span></span><span class="line"><span class="cl">   
</span></span><span class="line"><span class="cl">   <span class="c1">// Some properties and other methods...
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>   
</span></span><span class="line"><span class="cl">   <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">   <span class="kd">public</span> <span class="kt">int</span> <span class="nf">doStuff</span><span class="o">(</span><span class="kt">int</span> <span class="n">num</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">       <span class="c1">// perform operation
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>       <span class="c1">// postcondition 1: newNum &gt; num
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>       <span class="c1">// postcondition 2: newColor.equals(‚Äúblue‚Äù)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>   <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><p>The overridden <code>doStuff</code> method in Bar strengthens the postcondition by additionally ensuring that after the performed operations the <code>newColor</code> equals to ‚Äúblue‚Äù as well. Consequently, any client code relying on the postcondition of the <code>doStuff()</code> method in the <code>Foo</code> class notices no difference when it substitutes <code>Bar</code> for <code>Foo</code>. Because postcondition 1 is met as well in the subclass.<br>
Conversely, if <code>Bar</code> were to weaken the postcondition of the overridden <code>doStuff()</code> method (which is not allowed), it would no longer guarantee that newNum &gt; num. This might break client code given a Bar as a substitute for Foo.</p>
<h3 id="the-properties-rule">
  The properties rule
  <a class="heading-link" href="#the-properties-rule">
    <i class="fa fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<p>Definition:<br>
<em>&ldquo;The subtype must preserve all properties that can be proved about supertype objects.&rdquo; This rule states that all subtype methods (inherited and new) must maintain or strengthen the supertype‚Äôs class invariants.</em></p>
<p>Example: the <code>Foo</code> class defines a class invariant num &lt; upperLimit.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Foo</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">   
</span></span><span class="line"><span class="cl">   <span class="c1">// invariant: num &lt; upperLimit (should apply in every state)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>   
</span></span><span class="line"><span class="cl">   <span class="kd">private</span> <span class="kt">int</span> <span class="n">upperLimit</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   <span class="kd">public</span> <span class="kt">void</span> <span class="nf">doStuff</span><span class="o">(</span><span class="kt">int</span> <span class="n">num</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">       <span class="c1">// perform some operations
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>   <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><p>Let&rsquo;s now override the <code>doStuff()</code> method with a maintained/strengthened invariant:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Bar</span> <span class="kd">extends</span> <span class="n">Foo</span><span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   <span class="kd">private</span> <span class="kt">int</span> <span class="n">lowerLimit</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">   <span class="kd">public</span> <span class="kt">void</span> <span class="nf">doStuff</span><span class="o">(</span><span class="kt">int</span> <span class="n">num</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">       <span class="c1">// this method content has to maintain or strengthen the supertype‚Äôs class invariants
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>       <span class="c1">// Maintain-Example: ensuring that num &lt; upperLimit
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>       <span class="c1">// Strengthen-Example: ensuring that (num &lt; upperLimit) &amp;&amp; (num &gt; lowerLimit)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>   <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><p>In this example, the class invariant in <code>Foo</code> is preserved/strengthened by the overridden doStuff method in Bar. Conversely, if the class invariant is not preserved by the subtype (which is not allowed), it breaks any client code that relies on the supertype.</p>
<h4 id="the-history-constraint">
  The History Constraint
  <a class="heading-link" href="#the-history-constraint">
    <i class="fa fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h4>
<p>The history constraint states that the subclass methods (inherited or new) shouldn‚Äôt allow state changes that the base class didn‚Äôt allow. History constraints describe the &ldquo;historical evolution&rdquo; (=the state changes).</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">abstract</span> <span class="kd">class</span> <span class="nc">Car</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   <span class="c1">// mileage allowed to be set once at the time of creation.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>   <span class="c1">// mileage value can only increment thereafter.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>   <span class="c1">// mileage value cannot be reset.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>   <span class="kd">protected</span> <span class="kt">int</span> <span class="n">mileage</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   <span class="kd">public</span> <span class="nf">Car</span><span class="o">(</span><span class="kt">int</span> <span class="n">mileage</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">       <span class="k">this</span><span class="o">.</span><span class="na">mileage</span> <span class="o">=</span> <span class="n">mileage</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">   <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   <span class="c1">// Other properties and methods...
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><p>The Car class specifies a constraint on the mileage property. The mileage property can be set only once at the time of creation and cannot be reset thereafter.<br>
Let‚Äôs now define a ToyCar that extends Car:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ToyCar</span> <span class="kd">extends</span> <span class="n">Car</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   <span class="kd">public</span> <span class="kt">void</span> <span class="nf">reset</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">       <span class="n">mileage</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">   <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   <span class="c1">// Other properties and methods
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><p>The ToyCar has an extra method reset that resets the mileage property. In doing so, the ToyCar ignored the constraint imposed by its parent on the mileage property. This breaks any client code that relies on the constraint. So, ToyCar is <strong>not</strong> substitutable for Car.</p>
<h3 id="the-signature-rule">
  The Signature Rule
  <a class="heading-link" href="#the-signature-rule">
    <i class="fa fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<p>Definition:<br>
<em>&ldquo;The subtype objects must have all the methods of the supertype, and the signatures of the subtype methods must be compatible with the signatures of the corresponding supertype methods.&rdquo;</em></p>
<p>To recap:
The signature of a method is defined by:</p>
<ul>
<li>its name</li>
<li>the number of parameters</li>
<li>the type of parameters</li>
<li>the sequence/order of parameters</li>
</ul>
<h4 id="method-argument-types">
  Method argument types
  <a class="heading-link" href="#method-argument-types">
    <i class="fa fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h4>
<p>The rule states that the overridden subtype method argument types can be identical or wider than the supertype method argument types.
Java‚Äôs method overriding rules support this rule by enforcing that the overridden method argument types match exactly with the supertype method.</p>
<ul>
<li><em>If a method in the base class takes argument(s) of a given type, the overridden method should take the same type or a supertype (= contravariant method arguments).</em></li>
</ul>
<h4 id="return-types">
  Return types
  <a class="heading-link" href="#return-types">
    <i class="fa fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h4>
<p>The return type of the subtype method can be narrower than the return type of the supertype method. This is called covariance of the return types. Covariance indicates when a subtype is accepted in place of a supertype. Java supports the covariance of return types. Let‚Äôs look at an example:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">abstract</span> <span class="kd">class</span> <span class="nc">Foo</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   <span class="kd">public</span> <span class="kd">abstract</span> <span class="n">Number</span> <span class="nf">generateNumber</span><span class="o">();</span>    
</span></span><span class="line"><span class="cl">   
</span></span><span class="line"><span class="cl">   <span class="c1">// Other Methods
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><p>The <code>generateNumber()</code> method in <code>Foo</code> has defined the return type as <code>Number</code>. Let‚Äôs now override this method by returning a narrower type of e.g. <code>Integer</code>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Bar</span> <span class="kd">extends</span> <span class="n">Foo</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">   
</span></span><span class="line"><span class="cl">   <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">   <span class="kd">public</span> <span class="n">Integer</span> <span class="nf">generateNumber</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">       <span class="k">return</span> <span class="k">new</span> <span class="n">Integer</span><span class="o">(</span><span class="mi">10</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">   <span class="o">}</span>
</span></span><span class="line"><span class="cl">   
</span></span><span class="line"><span class="cl">   <span class="c1">// Other Methods
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><p>Because <code>Integer</code> IS-A <code>Number</code>, a client code that expects <code>Number</code> can replace <code>Foo</code> with <code>Bar</code> without any problems.
On the other hand, if the overridden method in <code>Bar</code> were to return a wider type than <code>Number</code>, e.g. <code>Object</code>, that might include any subtype of Object e.g. a Truck. Any client code that relied on the return type of Number could not handle a Truck!
Fortunately, Java‚Äôs method overriding rules prevent an overridden method returning a wider type.</p>
<ul>
<li>If a method in the base class returns void, the overridden method should return void</li>
<li>If a method in the base class returns a primitive, the overridden method should return the same primitive</li>
<li>If a method in the base class returns a certain type, the overridden method should return the same type or a subtype (= covariant return type)</li>
</ul>
<h4 id="exceptions">
  Exceptions
  <a class="heading-link" href="#exceptions">
    <i class="fa fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h4>
<p>The subtype method can throw fewer or narrower (but not any additional or broader) exceptions than the supertype method.
This is understandable because when the client code substitutes a subtype, it can handle, the method throwing fewer exceptions than the supertype method. However, if the subtype‚Äôs method throws new or broader checked exceptions, it would break the client code.
Java‚Äôs method overriding rules already enforce this rule for checked exceptions. However, overriding methods in Java CAN THROW any RuntimeException regardless of whether the overridden method declares the exception.</p>
<ul>
<li><em>If a method in the base class throws an exception, the overridden method must throw the same exception or a subtype of the base class exception.</em></li>
</ul>
<h2 id="summary-of-rules">
  Summary of rules:
  <a class="heading-link" href="#summary-of-rules">
    <i class="fa fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<ul>
<li>
<p>Preconditions cannot be strengthened in a subtype.</p>
</li>
<li>
<p>Postconditions cannot be weakened in a subtype.</p>
</li>
<li>
<p>Invariants of the supertype must be preserved (or strengthened) in a subtype.</p>
</li>
<li>
<p>History constraint: subclass methods shouldn‚Äôt allow state changes that the base class didn‚Äôt allow.</p>
</li>
<li>
<p>Subtype method argument types can be identical or wider than the supertype method argument types(= contravariant method arguments)</p>
</li>
<li>
<p>The return type of the subtype method can be narrower than the return type of the supertype method</p>
</li>
<li>
<p>If a method in the base class returns void, the overridden method should return void as well</p>
</li>
<li>
<p>If a method in the base class returns a primitive, the overridden method should return the same primitive</p>
</li>
<li>
<p>If a method in the base class returns a certain type, the overridden method should return the same type or a subtype (= covariant return type)</p>
</li>
</ul>
<p><strong>This is a lot to think about. How are you supposed to remember all this and apply it in your daily life as a software developer? In my opinion, there are two options:</strong></p>
<ol>
<li>
<p>You use inheritance in your code. However then you have to apply all these rules and think about all the mentioned stuff. If you don&rsquo;t, then your code is bad and breaks the LSP!</p>
</li>
<li>
<p>Don&rsquo;t use inheritance at all! Use composition instead! In this case you don&rsquo;t have to think about all the mentioned stuff. And your code is clean as well!</p>
</li>
</ol>
<p>I would go with option 2! üòâ</p>
<h2 id="why-is-lsp-so-important">
  Why is LSP so important?
  <a class="heading-link" href="#why-is-lsp-so-important">
    <i class="fa fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<p>I think LSP is so important because it ensures that no unexpected behaviour happens in the program. Therefore it is easier to maintain and easier to debug.<br>
Furthermore by following the LSP you can ensure that the building blocks of your application are more flexible and can be swapped out easily without having to fear that something breaks. For instance a <code>Cat</code> can be used instead of an <code>Animal</code> without any problems. We all know that changing and swapping things out are important things in software development. That&rsquo;s what also the &ldquo;Dependency Inversion Principle&rdquo; teaches us. Would you solder a lamp directly to the electrical wiring in a wall? Or would you use a plug instead?</p>
<figure><img src="/images/liskov-substitution-principle/dip.jpg"
         alt="Dependency Inversion Principle (Source: Stack Overflow)." width="400"/><figcaption>
            <p>Dependency Inversion Principle (Source: <a href="https://stackoverflow.com/questions/26447502/explain-this-motivational-poster-about-dependency-inversion-principle"  class="external-link" target="_blank" rel="noopener">Stack Overflow</a>).</p>
        </figcaption>
</figure>

<p><strong>Behavioral consistency:</strong><br>
The LSP ensures that an object of a derived type behaves exactly like an object of the base type. This allows objects to be exchanged arbitrarily without changing the program&rsquo;s behavior. This is important for the consistency and predictability of the code.</p>
<p><strong>Interoperability and Extensibility:</strong><br>
By following the LSP, different classes that implement the same base type can seamlessly interact with each other. This facilitates the integration of new classes into existing systems without requiring changes to existing code (See: Open Closed Principle).</p>
<p><strong>Documentation and Understandability:</strong><br>
The LSP contributes to better code understandability. When developers know that they can exchange objects without causing unexpected side effects, the code becomes more transparent and easier to understand.</p>
<p><strong>Testability:</strong><br>
Classes that adhere to the LSP are generally more testable. Tests written for the base type can also be used for derived types without requiring specific adjustments.</p>
<h2 id="conclusion">
  Conclusion
  <a class="heading-link" href="#conclusion">
    <i class="fa fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<p>I don‚Äôt think LSP is difficult to understand. However I think it is difficult to actually follow it. Most of the time subclassing is done wrong. Most of the time subclassing is used too much or it is used in situations where it should not be used. Inheritance should not be overused!</p>
<p>A fundamental Rule in OOP states: <em><strong>&ldquo;Favor composition over inheritance!&rdquo;</strong></em></p>
<p>So maybe in the next situation where you think about using inheritance to solve a problem, you should ask yourself the question: ‚ÄúHow could I solve the problem by using composition?‚Äù. I would argue that most of the time composition would lead to a better solution than inheritance.<br>
I would even go one step further: Ideally, inheritance should not be used anywhere in your code. Now you might be wondering: what was the point of this article then if inheritance shouldn&rsquo;t be used anyway? Well, unfortunately, inheritance is still used very often. In Java, for example, it is a fundamental concept on which the entire language is built on.</p>
<p>While programming you should ask yourself the questions:</p>
<ul>
<li>Could the problem be solved better by using composition?</li>
<li>Is my subclass substitutable for the base class without breaking the program?</li>
<li>Is my subclass in an &ldquo;is-a&rdquo; relationship to the base class? Is my cat an animal? is my dog an animal? is my table an animal?</li>
<li>What are my preconditions, postconditions and invariants?</li>
<li>Do I break the signature-, properties- or method rule?</li>
</ul>
<h2 id="reference">
  Reference
  <a class="heading-link" href="#reference">
    <i class="fa fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<ul>
<li>
<p><a href="https://de.wikipedia.org/wiki/Design_by_Contract"  class="external-link" target="_blank" rel="noopener">https://de.wikipedia.org/wiki/Design_by_Contract</a></p>
</li>
<li>
<p><a href="https://docplayer.org/4165643-Design-by-contract-in-java.html"  class="external-link" target="_blank" rel="noopener">Design By Contract in Java - Seminarbericht WS06/07 - Matthias Hausherr</a></p>
</li>
<li>
<p>Program Development in Java: Abstraction, Specification, and Object-Oriented Design,</p>
</li>
<li>
<p>Clean Architecture: A Craftsman&rsquo;s Guide to Software Structure and Design: A Craftsman&rsquo;s Guide to Software Structure and Design (Robert C. Martin Series)</p>
</li>
<li>
<p><a href="https://www.baeldung.com/java-liskov-substitution-principle"  class="external-link" target="_blank" rel="noopener">https://www.baeldung.com/java-liskov-substitution-principle</a></p>
</li>
<li>
<p><a href="https://www.baeldung.com/java-method-overload-override"  class="external-link" target="_blank" rel="noopener">https://www.baeldung.com/java-method-overload-override</a></p>
</li>
<li>
<p>University Lecture called ‚ÄúSoftware Design Methods‚Äù
by Ing. Dr. Hans J. Pr√ºller, B.Sc.
Personal website: <a href="https://hansprueller.lbs-logics.com/"  class="external-link" target="_blank" rel="noopener">https://hansprueller.lbs-logics.com/</a></p>
</li>
<li>
<p><a href="https://www.youtube.com/watch?v=ObHQHszbIcE"  class="external-link" target="_blank" rel="noopener">https://www.youtube.com/watch?v=ObHQHszbIcE</a></p>
</li>
<li>
<p><a href="https://www.youtube.com/watch?v=dJQMqNOC4Pc&amp;t=176s"  class="external-link" target="_blank" rel="noopener">https://www.youtube.com/watch?v=dJQMqNOC4Pc&t=176s</a></p>
</li>
<li>
<p><a href="https://www.youtube.com/watch?v=bVwZquRH1Vk&amp;t=144s"  class="external-link" target="_blank" rel="noopener">https://www.youtube.com/watch?v=bVwZquRH1Vk&t=144s</a></p>
</li>
<li>
<p><a href="https://en.wikipedia.org/wiki/Covariance_and_contravariance_%28computer_science%29"  class="external-link" target="_blank" rel="noopener">https://en.wikipedia.org/wiki/Covariance_and_contravariance_(computer_science)</a></p>
</li>
<li>
<p><a href="https://vowi.fsinf.at/wiki/TU_Wien:Fortgeschrittene_objektorientierte_Programmierung_VU_%28Puntigam%29/Mitschrift_SS17"  class="external-link" target="_blank" rel="noopener">https://vowi.fsinf.at/wiki/TU_Wien:Fortgeschrittene_objektorientierte_Programmierung_VU_(Puntigam)/Mitschrift_SS17</a></p>
</li>
</ul>

      </div>


      <footer>
        


        
        
        
        
        
      </footer>
    </article>

    
  </section>

    </div>

    <footer class="footer">
  <section class="container">
    ¬©
    
    2024
     Johannes Gerstbauer 
    ¬∑
    
    Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> & <a href="https://github.com/luizdepra/hugo-coder/" target="_blank" rel="noopener">Coder</a>.
    
  </section>
</footer>

  </main>

  

  
  
  <script src="/js/coder.min.6ae284be93d2d19dad1f02b0039508d9aab3180a12a06dcc71b0b0ef7825a317.js" integrity="sha256-auKEvpPS0Z2tHwKwA5UI2aqzGAoSoG3McbCw73gloxc="></script>
  

  

  


  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
</body>

</html>
