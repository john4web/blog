<!DOCTYPE html>
<html lang="en">

<head>
  <title>
  Elasticsearch Basics Â· gersti.at
</title>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="color-scheme" content="light dark">




<meta name="author" content="Johannes Gerstbauer">
<meta name="description" content="What is Elasticsearch? Link to heading Elasticsearch is a search engine written in java. You can think of it as a very fast/performant database, which is specialized on search capabilities (full-text search) and indexing large volumes of data. It allows users to perform complex queries, filter and aggregate data
Why using Elasticsearch? Link to heading Why do people use Elasticsearch at all instead of a relational database like MySQL? Because Elasticsearch is much more performant and optimized for search functionalities.">
<meta name="keywords" content="blog, developer, software, engineer">

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Elasticsearch Basics"/>
<meta name="twitter:description" content="What is Elasticsearch? Link to heading Elasticsearch is a search engine written in java. You can think of it as a very fast/performant database, which is specialized on search capabilities (full-text search) and indexing large volumes of data. It allows users to perform complex queries, filter and aggregate data
Why using Elasticsearch? Link to heading Why do people use Elasticsearch at all instead of a relational database like MySQL? Because Elasticsearch is much more performant and optimized for search functionalities."/>

<meta property="og:title" content="Elasticsearch Basics" />
<meta property="og:description" content="What is Elasticsearch? Link to heading Elasticsearch is a search engine written in java. You can think of it as a very fast/performant database, which is specialized on search capabilities (full-text search) and indexing large volumes of data. It allows users to perform complex queries, filter and aggregate data
Why using Elasticsearch? Link to heading Why do people use Elasticsearch at all instead of a relational database like MySQL? Because Elasticsearch is much more performant and optimized for search functionalities." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://gersti.at/todo/elasticsearch-basics/" /><meta property="article:section" content="TODO" />
<meta property="article:published_time" content="2024-01-24T00:00:00+00:00" />
<meta property="article:modified_time" content="2024-01-24T00:00:00+00:00" />




<link rel="canonical" href="https://gersti.at/todo/elasticsearch-basics/">


<link rel="preload" href="/fonts/forkawesome-webfont.woff2?v=1.2.0" as="font" type="font/woff2" crossorigin>


  
  
  <link rel="stylesheet" href="/css/coder.min.e1bdf152d93b060b06ba5d496486ed9c201a8b95d335e035beb5faebe3b61cad.css" integrity="sha256-4b3xUtk7BgsGul1JZIbtnCAai5XTNeA1vrX66&#43;O2HK0=" crossorigin="anonymous" media="screen" />






  
    
    
    <link rel="stylesheet" href="/css/coder-dark.min.a00e6364bacbc8266ad1cc81230774a1397198f8cfb7bcba29b7d6fcb54ce57f.css" integrity="sha256-oA5jZLrLyCZq0cyBIwd0oTlxmPjPt7y6KbfW/LVM5X8=" crossorigin="anonymous" media="screen" />
  



 




<link rel="icon" type="image/svg+xml" href="/images/favicon.svg" sizes="any">
<link rel="icon" type="image/png" href="/images/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/images/favicon-16x16.png" sizes="16x16">

<link rel="apple-touch-icon" href="/images/apple-touch-icon.png">
<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/images/safari-pinned-tab.svg" color="#5bbad5">









</head>






<body class="preload-transitions colorscheme-auto">
  
<div class="float-container">
    <a id="dark-mode-toggle" class="colorscheme-toggle">
        <i class="fa fa-adjust fa-fw" aria-hidden="true"></i>
    </a>
</div>


  <main class="wrapper">
    <nav class="navigation">
  <section class="container">
    <a class="navigation-title" href="/">
      gersti.at
    </a>
    
      <input type="checkbox" id="menu-toggle" />
      <label class="menu-button float-right" for="menu-toggle">
        <i class="fa fa-bars fa-fw" aria-hidden="true"></i>
      </label>
      <ul class="navigation-list">
        
          
            <li class="navigation-item">
              <a class="navigation-link" href="/posts/">Blog</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link" href="/about/">About</a>
            </li>
          
        
        
          
          
          
            
          
            
              
                <li class="navigation-item menu-separator">
                  <span>|</span>
                </li>
                
              
              <li class="navigation-item">
                <a href="/de/">ðŸ‡©ðŸ‡ª</a>
              </li>
            
          
        
      </ul>
    
  </section>
</nav>


    <div class="content">
      
  <section class="container page">
  <article>
    <header>
      <h1 class="title">
        <a class="title-link" href="https://gersti.at/todo/elasticsearch-basics/">
          Elasticsearch Basics
        </a>
      </h1>
    </header>

    <h2 id="what-is-elasticsearch">
  What is Elasticsearch?
  <a class="heading-link" href="#what-is-elasticsearch">
    <i class="fa fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<p>Elasticsearch is a search engine written in java. You can think of it as a very fast/performant database, which is specialized on search capabilities (full-text search) and indexing large volumes of data. It allows users to perform complex queries, filter and aggregate data</p>
<h2 id="why-using-elasticsearch">
  Why using Elasticsearch?
  <a class="heading-link" href="#why-using-elasticsearch">
    <i class="fa fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<p>Why do people use Elasticsearch at all instead of a relational database like MySQL? Because Elasticsearch is much more performant and optimized for search functionalities. Typically, data is &ldquo;copied&rdquo; from a database into an Elasticsearch index because it is much faster and more performant when accessed there. This high performance is achieved, among other things, through the &ldquo;inverted index.&rdquo; You can then communicate with this Elasticsearch index via a REST interface, which is precisely optimized for tasks like &ldquo;searching&rdquo; in applications. However Elasticsearch has several other advantages.</p>
<h2 id="documents-indices-and-clusters">
  Documents, Indices and clusters
  <a class="heading-link" href="#documents-indices-and-clusters">
    <i class="fa fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<p>When thinking about a relational database schema, we have databases, tables and rows. In Elasticsearch we kinda have the same concept. However in Elasticsearch they are called <strong>clusters, indices and documents</strong>.</p>
<h3 id="cluster">
  cluster
  <a class="heading-link" href="#cluster">
    <i class="fa fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<p>An ElasticSearch Cluster is the equivalent to a Database in SQL.</p>
<h3 id="indices">
  indices
  <a class="heading-link" href="#indices">
    <i class="fa fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<p>Indices are like tables in SQL. An index powers search into all documents within a collection of types. They contain inverted indices that let you search across everything within them at once, and mappings that define schemas for the data within.</p>
<h3 id="documents">
  documents
  <a class="heading-link" href="#documents">
    <i class="fa fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<p>Documents are like records in an SQL table. Documents are the things you&rsquo;re searching for. They can be more than text â€“ any structured JSON data works. Every document has a unique ID, and a type.</p>
<p>The schema for your documents are defined by the index respectively the document type associated by the index.</p>
<h2 id="inverted-index">
  Inverted Index
  <a class="heading-link" href="#inverted-index">
    <i class="fa fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<p>Elasticsearch&rsquo;s high performance is largely due to its use of an inverted index. An inverted index is a data structure used to enable fast full-text searches. It maps terms to the documents that contain them, allowing Elasticsearch to quickly retrieve and rank documents based on search queries. This is particularly efficient for searching large volumes of data, as the inverted index allows Elasticsearch to quickly locate and retrieve the relevant documents without scanning the entire dataset.</p>
<p><strong>&ldquo;The inverted index quickly maps search terms to documents&rdquo;</strong></p>
<p>How does this work? Let&rsquo;s take a look at an example. In the following, you can see two documents with some text in it:</p>
<ul>
<li><strong>Document 1:</strong> <em>Space: The final frontier. These are the voyages&hellip;</em></li>
<li><strong>Document 2:</strong> <em>He&rsquo;s bad, he&rsquo;s number one. He&rsquo;s the space cowboy with the laser gun!</em></li>
</ul>
<p>Elasticsearch now takes a look at all the search terms and &ldquo;remembers&rdquo;, in which documents they occur. As shown in the following table:</p>
<table>
<thead>
<tr>
<th>Search Term</th>
<th>Documents</th>
</tr>
</thead>
<tbody>
<tr>
<td>space</td>
<td>1, 2</td>
</tr>
<tr>
<td>the</td>
<td>1, 2</td>
</tr>
<tr>
<td>final</td>
<td>1</td>
</tr>
<tr>
<td>frontier</td>
<td>1</td>
</tr>
<tr>
<td>he</td>
<td>2</td>
</tr>
<tr>
<td>bad</td>
<td>2</td>
</tr>
<tr>
<td>&hellip;</td>
<td>&hellip;</td>
</tr>
</tbody>
</table>
<h2 id="relevance">
  Relevance
  <a class="heading-link" href="#relevance">
    <i class="fa fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<p>How to deal with the concept of relevance?
TF-IDF means Term Frequency * Inverse Document Frequency</p>
<p>Term Frequency is how often a term appears in a given document. If the term space appears very frequently in a given document, then it would have a high term frequency.</p>
<p>Document Frequency is how often a term appears in all documents in your entire index</p>
<p>If you divide the Term Frequency by the Document Frequency, you get the relevance of a term in a document (= we see how special this term is to the document).</p>
<p>This is how search engines work. If you search for a given term, it will try to give you back results in the order of their relevance.</p>
<h2 id="elasticsearchs-rest-interface">
  ElasticSearch&rsquo;s REST Interface
  <a class="heading-link" href="#elasticsearchs-rest-interface">
    <i class="fa fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<p>You can communicate with Elasticsearch via REST i.e. (GET, POST, PUT, DELETE).</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">curl -XGET 127.0.0.1:9200/shakespeare/_search?pretty -d
</span></span><span class="line"><span class="cl"><span class="s1">&#39;{
</span></span></span><span class="line"><span class="cl"><span class="s1">    &#34;query&#34;:{
</span></span></span><span class="line"><span class="cl"><span class="s1">        &#34;match_phrase&#34;:{
</span></span></span><span class="line"><span class="cl"><span class="s1">            &#34;text_entry&#34;: &#34;to be or not to be&#34;
</span></span></span><span class="line"><span class="cl"><span class="s1">        }
</span></span></span><span class="line"><span class="cl"><span class="s1">    }
</span></span></span><span class="line"><span class="cl"><span class="s1">
</span></span></span><span class="line"><span class="cl"><span class="s1">}&#39;</span>
</span></span></code></pre></div><p>In this example, we are querying the Shakespeare index for the phrase &ldquo;to be or not to be&rdquo;.
&ldquo;_search&rdquo; means that we wanna search and &ldquo;pretty&rdquo; means that the result should be formatted.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">curl -XPUT 127.0.0.1:9200/movies/movie/109487 -d
</span></span><span class="line"><span class="cl"><span class="s1">&#39;{
</span></span></span><span class="line"><span class="cl"><span class="s1">    &#34;genre&#34;: [&#34;IMAX&#34;, &#34;Sci-Fi&#34;],
</span></span></span><span class="line"><span class="cl"><span class="s1">    &#34;title&#34;: &#34;Interstellar&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s1">    &#34;year&#34;: 2014
</span></span></span><span class="line"><span class="cl"><span class="s1">
</span></span></span><span class="line"><span class="cl"><span class="s1">}&#39;</span>
</span></span></code></pre></div><p>In this example we are inserting data into the index.
&ldquo;-d&rdquo; -&gt; specifies the data that should be inserted<br>
movies -&gt; this is the index name<br>
movie -&gt; this is the data type<br>
109487 -&gt; this is the unique identifier</p>
<h2 id="mapping">
  Mapping
  <a class="heading-link" href="#mapping">
    <i class="fa fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<p>A mapping is a schema definition. ElasticSearch has reasonable defaults, but sometimes you need to customize them. Mappings tell elasticsearch &ldquo;how&rdquo; to store the information. It tells elasticsearch what format to store the data in and how to index it and how to analyze it.</p>
<p>Example of importing some movie data into elasticsearch where we want the year to be explicitely interpreted as a date-type field.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">curl -XPUT 127.0.0.1:9200/movies/ -d
</span></span><span class="line"><span class="cl"><span class="s1">&#39;{
</span></span></span><span class="line"><span class="cl"><span class="s1">    &#34;mappings&#34;: {
</span></span></span><span class="line"><span class="cl"><span class="s1">        &#34;proterties&#34;: {
</span></span></span><span class="line"><span class="cl"><span class="s1">            &#34;year&#34;: {
</span></span></span><span class="line"><span class="cl"><span class="s1">                &#34;type&#34;: &#34;date&#34;
</span></span></span><span class="line"><span class="cl"><span class="s1">            }
</span></span></span><span class="line"><span class="cl"><span class="s1">        }
</span></span></span><span class="line"><span class="cl"><span class="s1">    }
</span></span></span><span class="line"><span class="cl"><span class="s1">}&#39;</span>
</span></span></code></pre></div><p>You can get the mapping information of an Index with the following command:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">curl -XGET <span class="s2">&#34;http://127.0.0.1:9200/demo-default/_mapping?pretty=true&#34;</span>
</span></span></code></pre></div><p>This gets the mapping information of an Index called &ldquo;demo-default&rdquo;.</p>
<p>mappings can define different things:</p>
<h3 id="field-types">
  Field types
  <a class="heading-link" href="#field-types">
    <i class="fa fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<p>These are types, that elastic search recognizes: string, byte, short, integer, long, float, double, boolean, date</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl">    <span class="s2">&#34;proterties&#34;</span><span class="err">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;user_id&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;long&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span></code></pre></div><h3 id="field-index">
  Field index
  <a class="heading-link" href="#field-index">
    <i class="fa fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<p>Here you can specify whether you want this field indexed for full-text search or not.
If you specify <code>&quot;index&quot;: &quot;not_analyzed&quot;</code>, then it won&rsquo;t be found.
<code>&quot;index&quot;: &quot;analyzed&quot;</code>and <code>&quot;index&quot;: &quot;no&quot;</code> is also possible.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl">    <span class="s2">&#34;proterties&#34;</span><span class="err">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;genre&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;index&#34;</span><span class="p">:</span> <span class="s2">&#34;not_analyzed&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span></code></pre></div><h3 id="field-analyzer">
  Field Analyzer
  <a class="heading-link" href="#field-analyzer">
    <i class="fa fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<p>Here you can define your tokenizer and token filter.</p>
<p>You can specify the language for instance:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl">    <span class="s2">&#34;proterties&#34;</span><span class="err">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;analyzer&#34;</span><span class="p">:</span> <span class="s2">&#34;english&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span></code></pre></div><p>There are three things an Analyzer can do:</p>
<ol>
<li>
<p><strong>Character Filters:</strong> remove HTML encoding, convert <code>&amp;</code> to <code>and</code>
for example: if someone searches for <code>and</code> or someone searches for <code>&amp;</code>, then in bot cases, the result with <code>&amp;</code> will be returned from the search. For example &ldquo;Kaffee&amp;Kuchen&rdquo;.</p>
</li>
<li>
<p><strong>Tokenizer:</strong> split strings up in a certain way.
You can define what is a word by splitting strings up by whitespace or punctuation or non-letters, etc.</p>
</li>
<li>
<p><strong>Token Filter:</strong> can do lowercasing, stemming, synonyms and stopwords</p>
</li>
</ol>
<p><strong>Lowercasing:</strong> The token filter converts everything to lowercase. When you want to do a case-insensitive search, then you can use that.</p>
<p><strong>Stemming:</strong> When you search for box, then the search should also return all terms that contain the following: boxes, boxing, boxed, box</p>
<p><strong>Synonyms:</strong> If you search for &ldquo;big&rdquo;, then the search should also return &ldquo;large&rdquo; in the result set.</p>
<p><strong>Stopwords:</strong> If you want to save space and avoid storing insignificant words like &ldquo;and,&rdquo; &ldquo;the,&rdquo; &ldquo;a,&rdquo; etc. These words don&rsquo;t carry much information and are therefore not as important. However, there are also situations where you definately don&rsquo;t want to do that. So think wisely if you want to exclude such stopwords. Carefully consider whether you need them in your search. Stopwords can sometimes lead to unintended side effects.</p>
<h3 id="choices-for-analyzers">
  Choices for analyzers:
  <a class="heading-link" href="#choices-for-analyzers">
    <i class="fa fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<p>There are some predefined analyzers that you can use:</p>
<p><strong>Standard</strong>
Splits on word boundaries, removes punctuation, lowercases. Good choice if language is unknown.</p>
<p><strong>Simple</strong>
Splits on anything that isn&rsquo;t a letter, and lowercase</p>
<p><strong>Whitespace</strong>
Splits on whitespace but doesn&rsquo;t lowercase</p>
<p><strong>Language (i.e. english)</strong>
Accounts for language-specific stopwords and stemming</p>
<h2 id="reference">
  Reference
  <a class="heading-link" href="#reference">
    <i class="fa fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<p>Frank Kane: Elasticsearch 8 and the Elastic Stack: In-Depth and Hands-On
<a href="https://www.oreilly.com/library/view/elasticsearch-8-and/9781788995122/"  class="external-link" target="_blank" rel="noopener">https://www.oreilly.com/library/view/elasticsearch-8-and/9781788995122/</a></p>

  </article>
</section>

  

    </div>

    <footer class="footer">
  <section class="container">
    Â©
    
    2024
     Johannes Gerstbauer 
    Â·
    
    Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> & <a href="https://github.com/luizdepra/hugo-coder/" target="_blank" rel="noopener">Coder</a>.
    
  </section>
</footer>

  </main>

  

  
  
  <script src="/js/coder.min.6ae284be93d2d19dad1f02b0039508d9aab3180a12a06dcc71b0b0ef7825a317.js" integrity="sha256-auKEvpPS0Z2tHwKwA5UI2aqzGAoSoG3McbCw73gloxc="></script>
  

  

  


  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
</body>

</html>
